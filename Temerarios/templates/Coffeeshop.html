{% extends "index.html" %}

{% block title %}
Coffee Shop
{% endblock %}

{% block main %}
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<link href="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.1/dist/sweetalert2.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.1/dist/sweetalert2.min.js"></script>
<nav class="navbar navbar-expand-lg navbar-light"
    style="background-color: #AAB396; padding: 10px 20px; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);">
    <div class="container-fluid">
        <a class="navbar-brand d-flex align-items-center" href="index.html">
            <img src="/static/logosinfondo.png" alt="RTC" class="me-2" style="max-width: 100px; height: auto;">
            <span style="font-weight: bold; font-size: 1.5rem; color: #000000; transition: all 0.3s;">Rincón
                Temerario</span>
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
            aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <!-- direccion de cada plantilla -->
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto">
                <li class="nav-item">
                    <a class="nav-link nav-animated" href="{{ url_for('index') }}"
                        style="color: #000000; font-size: 18px; margin: 0 10px;">Inicio</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link nav-animated" href="/about"
                        style="color: #000000; font-size: 18px; margin: 0 10px;">Nosotros</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link nav-animated" href="/Coffeeshop"
                        style="color: #000000; font-size: 18px; margin: 0 10px;">Coffee Shop</a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<div class="container my-5">
    <h2>Coffee Shop</h2>
    <p>Mostrando productos por categoría</p>
    <div class="d-flex justify-content-end mb-3">
        <select class="form-select" aria-label="Categoría">
            <option selected>Categoría</option>
            <option value="1">Accesorios</option>
            <option value="2">Café</option>
            <option value="3">Postres</option>
        </select>
    </div>

    <!-- Estilos para las imágenes -->
    <style>
        .product-image {
            width: 200px;
            /* Ancho fijo */
            height: 200px;
            /* Altura fija */
            object-fit: cover;
            /* Ajuste sin deformación */
            border-radius: 10px;
            /* Opcional: bordes redondeados */
            margin: 10px auto;
            /* Centrar dentro del contenedor */
        }
    </style>


    <!-- Accesorios: Tazas -->
    <h3>Accesorios - Tazas</h3>
    <div class="row">
        <div class="col-md-4">
            <div class="product-card">
                <img src="/static/Taza3.png" alt="Taza con Cuchara" class="product-image">
                <div class="product-name">Taza con Cuchara</div>
                <div class="product-price">$10.99</div>
                <button class="btn btn-primary add-to-cart" data-name="Taza con Cuchara" data-price="10.99"
                    data-image="imagenes/Taza3.png">Add to carrito</button>
            </div>
        </div>
        <div class="col-md-4">
            <div class="product-card">
                <img src="/static/Taza4.png" alt="Taza Negra" class="product-image">
                <div class="product-name">Taza Negra</div>
                <div class="product-price">$12.99</div>
                <button class="btn btn-primary add-to-cart" data-name="Taza Negra" data-price="12.99"
                    data-image="imagenes/Taza4.png">Add to carrito</button>
            </div>
        </div>
        <div class="col-md-4">
            <div class="product-card">
                <img src="/static/Taza1.png" alt="Taza Blanca" class="product-image">
                <div class="product-name">Taza Blanca</div>
                <div class="product-price">$14.99</div>
                <button class="btn btn-primary add-to-cart" data-name="Taza Blanca" data-price="14.99"
                    data-image="imagenes/Taza1.png">Add to carrito</button>

            </div>
        </div>
    </div>

    <h3>Accesorios - Termos</h3>
    <div class="row">
        <div class="col-md-4">
            <div class="product-card">
                <img src="/static/Termo3.png" alt="Termo Clasico" class="product-image">
                <div class="product-name">Termo Clasico</div>
                <div class="product-price">$10.99</div>
                <button class="btn btn-primary add-to-cart" data-name="Termo Clasico" data-price="10.99"
                    data-image="imagenes/Termo3.png">Add to carrito</button>
            </div>
        </div>
        <div class="col-md-4">
            <div class="product-card">
                <img src="/static/Termo5.png" alt="Termo Tipo Stanley" class="product-image">
                <div class="product-name">Termo Tipo Stanley</div>
                <div class="product-price">$12.99</div>
                <button class="btn btn-primary add-to-cart" data-name="Termo Tipo Stanley" data-price="12.99"
                    data-image="imagenes/Termo5.png">Add to carrito</button>

            </div>
        </div>
        <div class="col-md-4">
            <div class="product-card">
                <img src="/static/Termo6.png" alt="Termo Blanco" class="product-image">
                <div class="product-name">Termo Blanco</div>
                <div class="product-price">$14.99</div>
                <button class="btn btn-primary add-to-cart" data-name="Termo Blanco" data-price="14.99"
                    data-image="imagenes/Termo6.png">Add to carrito</button>

            </div>
        </div>
    </div>

    <h3>Accesorios - Libretas</h3>
    <div class="row">
        <div class="col-md-4">
            <div class="product-card">
                <img src="/static/Libreta1.png" alt="Libreta Clasica Negra" class="product-image">
                <div class="product-name">Libreta Clasica Negra</div>
                <div class="product-price">$10.99</div>
                <button class="btn btn-primary add-to-cart" data-name="Libreta Clasica Negra" data-price="10.99"
                    data-image="imagenes/Libreta1.png">Add to carrito</button>

            </div>
        </div>
        <div class="col-md-4">
            <div class="product-card">
                <img src="/static/Libreta6.png" alt="Libreta Verde" class="product-image">
                <div class="product-name">Libreta Verde</div>
                <div class="product-price">$12.99</div>
                <button class="btn btn-primary add-to-cart" data-name="Libreta Verde" data-price="12.99"
                    data-image="imagenes/Libreta6.png">Add to carrito</button>
            </div>
        </div>
        <div class="col-md-4">
            <div class="product-card">
                <img src="/static/Libreta7.png" alt="Libreta Negra" class="product-image">
                <div class="product-name">Libreta Negra</div>
                <div class="product-price">$14.99</div>
                <button class="btn btn-primary add-to-cart" data-name="Libreta Negra" data-price="14.99"
                    data-image="imagenes/Libreta7.png">Add to carrito</button>

            </div>
        </div>
    </div>

    <h3>Cafés</h3>
    <div class="row">
        <div class="col-md-4">
            <div class="product-card">
                <img src="/static/vainilla.png" alt="Café con Vainilla" class="product-image">
                <div class="product-name">Café con Vainilla</div>
                <div class="product-price">$10.99</div>
                <button class="btn btn-primary add-to-cart" data-name="Café con Vainilla" data-price="10.99"
                    data-image="imagenes/vainilla.png">Add to carrito</button>

            </div>
        </div>
        <div class="col-md-4">
            <div class="product-card">
                <img src="/static/Chocolate.png" alt="Café Con Chocolate" class="product-image">
                <div class="product-name">Café con Chocolate</div>
                <div class="product-price">$12.99</div>
                <button class="btn btn-primary add-to-cart" data-name="Café Con Chocolate" data-price="12.99"
                    data-image="imagenes/Chocolate.png">Add to carrito</button>

            </div>
        </div>
        <div class="col-md-4">
            <div class="product-card">
                <img src="/static/Cafépuro.png" alt="Café Puro" class="product-image">
                <div class="product-name">Cafe Puro</div>
                <div class="product-price">$14.99</div>
                <button class="btn btn-primary add-to-cart" data-name="Café Puro" data-price="14.99"
                    data-image="imagenes/Cafépuro.png">Add to carrito</button>
            </div>
        </div>
    </div>


    <h3>Postres</h3>
    <div class="row">
        <div class="col-md-4">
            <div class="product-card">
                <img src="/static/selvanegra.png" alt="Selva Negra" class="product-image">
                <div class="product-name">Selva Negra</div>
                <div class="product-price">$10.99</div>
                <button class="btn btn-primary add-to-cart" data-name="Selva Negra" data-price="10.99"
                    data-image="imagenes/selvanegra.png">Add to carrito</button>
            </div>
        </div>
        <div class="col-md-4">
            <div class="product-card">
                <img src="/static/redvelvet.png" alt="Red Velvet" class="product-image">
                <div class="product-name">Red Velvet</div>
                <div class="product-price">$12.99</div>
                <button class="btn btn-primary add-to-cart" data-name="Red Velvet" data-price="12.99"
                    data-image="imagenes/redvelvet.png">Add to carrito</button>
            </div>
        </div>
        <div class="col-md-4">
            <div class="product-card">
                <img src="/static/tresleches.png" alt="Tres Leches" class="product-image">
                <div class="product-name">Tres Leches</div>
                <div class="product-price">$14.99</div>
                <button class="btn btn-primary add-to-cart" data-name="Tres Leches" data-price="14.99"
                    data-image="imagenes/tresleches.png">Add to carrito</button>
            </div>
        </div>
    </div>

    <!-- Modal de Iniciar Sesión o Registrarse -->
    <div class="modal fade" id="authModal" tabindex="-1" aria-labelledby="authModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="authModalLabel">¡Atención!</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Para añadir productos al carrito, necesita tener una cuenta.</p>
                    <p>¿Ya tiene una cuenta?</p>
                </div>
                <div class="modal-footer">
                    <a href="/login" class="btn btn-primary">Iniciar Sesión</a>
                    <a href="/register" class="btn btn-secondary">Registrarse</a>
                </div>
            </div>
        </div>
    </div>

</div>

<script>
    document.getElementById('categorySelect').addEventListener('change', function () {
        const selectedCategory = this.value;
        document.querySelectorAll('.product-card').forEach(card => {
            if (selectedCategory === 'all' || card.getAttribute('data-category') === selectedCategory) {
                card.style.display = 'block';
            } else {
                card.style.display = 'none';
            }
        });
    });
</script>

<script>
    function addToCart(product) {
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        cart.push(product);
        localStorage.setItem('cart', JSON.stringify(cart));
        Swal.fire({
            title: "Agregado al carrito",
            text: `${product.name} ha sido añadido al carrito`,
            icon: "success"
        });
    }

    // Asignar evento a todos los botones "Add to carrito"
    document.querySelectorAll('.add-to-cart').forEach(button => {
        button.addEventListener('click', function () {
            const product = {
                name: this.getAttribute('data-name'),
                price: parseFloat(this.getAttribute('data-price')),
                image: this.getAttribute('data-image')
            };
            $.ajax({
                url: "verify_user",
                method: "post",
                data: {
                    name: product.name,
                    price: product.price
                },
                success: (respuesta) => {
                    if (respuesta.data === "verify") {
                        addToCart(product);
                    }
                },
                error: (xhr) => {
                    if (xhr.status === 404) {
                        const authModal = new bootstrap.Modal(document.getElementById('authModal'));
                        authModal.show();
                    }
                }

            })
            // Llamar la función para agregar el producto al carrito
            // Mostrar el modal(aviso)
        });
    });
</script>

<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"></script>
{% endblock %}